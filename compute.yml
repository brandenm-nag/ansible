---

- hosts: compute
  tasks:
    - name: disable SELinux
      selinux:
        state: disabled

- hosts: compute
  roles:
    - citc_user
    - filesystem
    - ssh
    #- security_updates
    - ntp
    - sssd
    - lmod
    - packages
    - devtoolset
    - mpi
    - slurm
    - spack_compute
    - monitoring

- hosts: compute
  tasks:
    - name: Set Proxy
      lineinfile:
        state: present
        path: /etc/environment
        line: "http_proxy=http://{{ mgmt_hostname }}:3128"
